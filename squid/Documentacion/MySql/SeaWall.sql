#CREA BASE DE DATOS
DROP DATABASE IF EXISTS SEAWALL;
CREATE DATABASE IF NOT EXISTS SEAWALL;

#ABRE BASE DE DATOS
USE SEAWALL;

DROP TABLE IF EXISTS Surfer;
DROP TABLE IF EXISTS Rule;
DROP TABLE IF EXISTS Privilege;
DROP TABLE IF EXISTS Content;
DROP TABLE IF EXISTS ActiveUser;
DROP TABLE IF EXISTS RuleList;
#CREANDO TABLAS

CREATE TABLE IF NOT EXISTS Privilege(
namePrivilege VARCHAR(128),
isBlock BOOLEAN,
CONSTRAINT PK_Privilege PRIMARY KEY (namePrivilege));

CREATE TABLE IF NOT EXISTS Surfer(
username VARCHAR(128),
pass VARCHAR(128),
namePrivilege VARCHAR(128) NOT NULL,
CONSTRAINT PK_Surfer PRIMARY KEY (username),
CONSTRAINT FK_Surfer_Privilege FOREIGN KEY (namePrivilege) REFERENCES Privilege(namePrivilege));

CREATE TABLE IF NOT EXISTS Rule(
nameURL VARCHAR(128),
idRule INT UNSIGNED AUTO_INCREMENT,
isContent BOOLEAN,
description TEXT,
allow BOOLEAN,
rFrom TIME,
rTo TIME,
CONSTRAINT PK_Rule PRIMARY KEY (idRule));

CREATE TABLE IF NOT EXISTS ActiveUser(
idActiveUser INT UNSIGNED AUTO_INCREMENT,
ipSurfer VARCHAR(15),
nameSurfer VARCHAR(128),
CONSTRAINT PK_ActiveUser PRIMARY KEY (idActiveUser),
CONSTRAINT FK_ActiveUser_Surfer FOREIGN KEY (nameSurfer) REFERENCES Surfer(username));

CREATE TABLE IF NOT EXISTS RuleList(
privilegeAsigned VARCHAR(128),
ruleAsigned INT UNSIGNED,
FOREIGN KEY (privilegeAsigned) REFERENCES Privilege(namePrivilege),
FOREIGN KEY (ruleAsigned) REFERENCES Rule(idRule));

CREATE TABLE IF NOT EXISTS Content(
nameContent VARCHAR(128),
urlList TEXT,
CONSTRAINT PK_Content PRIMARY KEY (nameContent));
